<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link href="../../CSS/bootstrap.min.css" rel="stylesheet" />
    <link href="../../CSS/STA.css" rel="stylesheet" />
    <link href="../../CSS/all.css" rel="stylesheet" />
    <script src="../../JScripts/all.min.js"></script>
    <script src="../../../ClientGlobalContext.js.aspx" type="text/javascript"></script>
    <script src="../../JScripts/jquery-3.5.1.min.js" type="text/javascript"></script>
    <script src="../../JScripts/CommonFunctions.js" type="text/javascript"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <div class="row">
                    <!--<div class="col-4"></div>-->
                    <div class="col-lg-12 col-md-12">
                        <!--<div class="row">
                        <div class="col-12">
                            <h5 class="headtxt">
                                <i class="fas fa-user"></i>
                                <span class="tracking-in-expand">International Visitor</span>
                            </h5>
                            <div id="PriorityCare" class="prioritycare">
                                Priority Care
                            </div>
                        </div>
                        </div>-->

                        <div class="row">
                            <div class="col-6 col-sm-4 col-md-3 slide-in-top">
                                <div class="flagbox" id="clsNPS">
                                    <i class="fas fa-award tilt-in-fwd-tr"></i>
                                    <div id="NPSVal" class="boxtxt slide-in-tl">N/A</div>
                                    <div id="EN" class="boxdes slide-in-tl none">Net Promoter Score (NPS)</div>
                                    <div id="AR" class="boxdes slide-in-tl none">(NPS)مجموع نقاط الترويج</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-tr">
                                <div class="flagbox" id="clsCES">
                                    <i class="fas fa-clipboard-list tilt-in-fwd-tr"></i>
                                    <div id="CESVal" class="boxtxt slide-in-tl">N/A</div>
                                    <div id="EN" class="boxdes slide-in-tl none"> Customer Effort Score (CES)</div>
                                    <div id="AR" class="boxdes slide-in-tl none">(CES)نقاط العميل</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-tr">
                                <div class="flagbox" id="clsCSAT">
                                    <i class="fas fa-user-check tilt-in-fwd-tr"></i>
                                    <div id="CSATVal" class="boxtxt slide-in-tl">N/A</div>
                                    <div id="EN" class="boxdes slide-in-tl none">Customer Satisfaction Score (CSAT)</div>
                                    <div id="AR" class="boxdes slide-in-tl none">(CSAT) نقاط رضا العملاء</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-tr">
                                <div class="flagbox" id="clsTtlCases">
                                    <i class="fas fa-folder tilt-in-fwd-tr"></i>
                                    <div id="TtlCasesVal" class="boxtxt slide-in-tl">0</div>
                                    <div id="EN" class="boxdes slide-in-tl none">Total Case Count</div>
                                    <div id="AR" class="boxdes slide-in-tl none">إجمالي عدد الحالات</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-br">
                                <div class="flagbox" id="clsCCCases">
                                    <i class="fas fa-copy tilt-in-fwd-tr"></i>
                                    <div id="CCCasesVal" class="boxtxt slide-in-tl" value="0"></div>
                                    <div id="EN" class="boxdes slide-in-tl none">Complaints</div>
                                    <div id="AR" class="boxdes slide-in-tl none">شكاوي</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-br">
                                <div class="flagbox" id="clsEQCases">
                                    <i class="fas fa-question-circle tilt-in-fwd-tr"></i>
                                    <div id="EQCasesVal" class="boxtxt slide-in-tl" value="0"></div>
                                    <div id="EN" class="boxdes slide-in-tl none">Enquiries</div>
                                    <div id="AR" class="boxdes slide-in-tl none">استفسارات</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-br">
                                <div class="flagbox" id="clsSGCases">
                                    <i class="fas fa-question-circle tilt-in-fwd-tr"></i>
                                    <div id="SGCasesVal" class="boxtxt slide-in-tl" value="0"></div>
                                    <div id="EN" class="boxdes slide-in-tl none">Suggestions</div>
                                    <div id="AR" class="boxdes slide-in-tl none">اقتراحات</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-bottom">
                                <div class="flagbox" id="clsEMCases">
                                    <i class="fas fa-exclamation-triangle tilt-in-fwd-tr"></i>
                                    <div id="EMCasesVal" class="boxtxt slide-in-tl" value="0"></div>
                                    <div id="EN" class="boxdes slide-in-tl none">Emergencies</div>
                                    <div id="AR" class="boxdes slide-in-tl none">حالات الطوارئ</div>
                                </div>
                            </div>
                            <div class="col-6 col-sm-4 col-md-3 slide-in-bottom">
                                <div class="flagbox" id="clsOSCases">
                                    <i class="fas fa-exclamation-triangle tilt-in-fwd-tr"></i>
                                    <div id="OSCasesVal" class="boxtxt slide-in-tl" value="0"></div>
                                    <div id="EN" class="boxdes slide-in-tl none">Out of Scope</div>
                                    <div id="AR" class="boxdes slide-in-tl none">أخرى</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var Xrm = parent.window.Xrm;
        document.onreadystatechange = function () {
            if (document.readyState == "complete" && Xrm != null && Xrm != undefined) {
                //
                var wrControl = Xrm.Page.getControl("WebResource_ContactRatingsForm_html");
                if (wrControl != null) {
                    window.Xrm = parent.window.Xrm;
                    window._formContext = wrControl.formContext;
                    setCustDetailsBtns();
                }
            }
        };

        function setCustDetailsBtns() {
            var /*SgmtVal = null, SgmtTxt = null,*/ NPSVal = null, NPSTxt = null, CESVal = null, CESTxt = null, CSATVal = null, CSATTxt = null;
            var TotalCasesVal = null, EmergenciesCasesVal = null, ComplaintCasesVal = null, EnquiryCasesVal = null, SuggestionCasesVal = null;
            var OutofScopeCasesVal = null;

            //SgmtVal = GetAttributeValue(_formContext, "tc_customersegment");
            //if (SgmtVal != null && SgmtVal[0] != null && SgmtVal[0].name != null) {
            //    SgmtTxt = SgmtVal[0].name;
            //}

            NPSVal = GetAttributeValue(_formContext, "tc_npsscore");
            if (NPSVal != null) {
                NPSTxt = _formContext.getAttribute("tc_npsscore").getText();
            }
            CESVal = GetAttributeValue(_formContext, "tc_cesscore");
            if (CESVal != null) {
                CESTxt = _formContext.getAttribute("tc_cesscore").getText();
            }
            CSATVal = GetAttributeValue(_formContext, "tc_csatscore");
            if (CSATVal != null) {
                CSATTxt = _formContext.getAttribute("tc_csatscore").getText();
            }

            TotalCasesVal = GetAttributeValue(_formContext, "tc_totalcasescount");
            EmergenciesCasesVal = GetAttributeValue(_formContext, "tc_emergenciescasescount");
            ComplaintCasesVal = GetAttributeValue(_formContext, "tc_complaintcasescount");
            EnquiryCasesVal = GetAttributeValue(_formContext, "tc_enquirycasescount");
            SuggestionCasesVal = GetAttributeValue(_formContext, "tc_suggestioncasescount");
            OutofScopeCasesVal = GetAttributeValue(_formContext, "tc_outofscopecasescount");

            //if (SgmtTxt != null) {
            //    $("#btnSgmt").prop("value", SgmtTxt);
            //    switch (SgmtTxt) {
            //        case "Saudi National":
            //        case "Saudi Expatriate":
            //            $("#btnSgmt").css("border-style", "ridge");
            //            $("#btnSgmt").css("background-color", "#358717");
            //            $("#btnSgmt").css("color", "white");
            //            break;
            //        case "International Visitor":
            //            $("#btnSgmt").css("border-style", "none");
            //            $("#btnSgmt").css("background-color", "#B8860B");
            //            $("#btnSgmt").css("color", "white");
            //            break;
            //        default:
            //            $("#btnSgmt").css("border-style", "none");
            //            $("#btnSgmt").css("background-color", "#E83D0F");
            //            $("#btnSgmt").css("color", "white");
            //            break;
            //    }
            //}
            //else {
            //    $("#btnSgmt").val("Segemnt-NA");
            //    $("#btnSgmt").css("border-style", "ridge");
            //    $("#btnSgmt").css("background-color", "none");
            //    $("#btnSgmt").css("color", "black");
            //}

            if (NPSVal != null) {
                $("#NPSVal").text(NPSTxt);
                switch (NPSVal) {
                    case 948010000: // NA
                        $("#clsNPS").addClass("disabled");
                        break;
                    case 948010001: // 1
                    case 948010002: // 2
                    case 948010003: // 3
                    case 948010004: // 4
                    case 948010005: // 5
                    case 948010006: // 6
                        $("#clsNPS").addClass("redbox");
                        break;
                    case 948010007: // 7
                    case 948010008: // 8
                        $("#clsNPS").addClass("aunmberbox");
                        break;
                    case 948010009: // 9
                    case 948010010: // 10
                        $("#clsNPS").addClass("greenbox");
                        break;
                }
            }
            else {
                $("#clsNPS").addClass("disabled");
            }

            if (CESVal != null) {
                $("#CESVal").text(CESTxt);
                switch (CESVal) {
                    case 948010000: // NA
                        $("#clsCES").addClass("disabled");
                        break;
                    case 948010001: // 1
                    case 948010002: // 2
                        $("#clsCES").addClass("redbox");
                        break;
                    case 948010003: // 3
                        $("#clsCES").addClass("aunmberbox");
                        break;
                    case 948010004: // 4
                    case 948010005: // 5
                        $("#clsCES").addClass("greenbox");
                        break;
                }
            }
            else {
                $("#clsCES").addClass("disabled");
            }

            if (CSATVal != null) {
                $("#CSATVal").text(CSATTxt);
                switch (CSATVal) {
                    case 948010000: // NA
                        $("#clsCSAT").addClass("disabled");
                        break;
                    case 948010001: // 1
                    case 948010002: // 2
                        $("#clsCSAT").addClass("redbox");
                        break;
                    case 948010003: // 3
                        $("#clsCSAT").addClass("aunmberbox");
                        break;
                    case 948010004: // 4
                    case 948010005: // 5
                        $("#clsCSAT").addClass("greenbox");
                        break;
                }
            }
            else {
                $("#clsCSAT").addClass("disabled");
            }

            $("#TtlCasesVal").text(TotalCasesVal);
            if (TotalCasesVal != null && TotalCasesVal != 0) {
                $("#clsTtlCases").addClass("defaultbox");
            }
            else {
                $("#clsTtlCases").addClass("disabled");
            }

            $("#EMCasesVal").text(EmergenciesCasesVal);
            if (EmergenciesCasesVal != null && EmergenciesCasesVal != 0) {
                $("#clsEMCases").addClass("defaultbox");
            }
            else {
                $("#clsEMCases").addClass("disabled");
            }

            $("#CCCasesVal").text(ComplaintCasesVal);
            if (ComplaintCasesVal != null && ComplaintCasesVal != 0) {
                $("#clsCCCases").addClass("defaultbox");
            }
            else {
                $("#clsCCCases").addClass("disabled");
            }

            $("#EQCasesVal").text(EnquiryCasesVal);
            if (EnquiryCasesVal != null && EnquiryCasesVal != 0) {
                $("#clsEQCases").addClass("defaultbox");
            }
            else {
                $("#clsEQCases").addClass("disabled");
            }

            $("#SGCasesVal").text(SuggestionCasesVal);
            if (SuggestionCasesVal != null && SuggestionCasesVal != 0) {
                $("#clsSGCases").addClass("defaultbox");
            }
            else {
                $("#clsSGCases").addClass("disabled");
            }

            $("#OSCasesVal").text(OutofScopeCasesVal);
            if (OutofScopeCasesVal != null && OutofScopeCasesVal != 0) {
                $("#clsOSCases").addClass("defaultbox");
            }
            else {
                $("#clsOSCases").addClass("disabled");
            }

            var currUserLcid = Xrm.Page.context.getUserLcid();
            switch (currUserLcid) {
                case 1025: //Arabic
                    $('div[id^="AR"]').removeClass("none");
                    $('div[id^="EN"]').removeClass("block");
                    $('div[id^="EN"]').addClass("none");
                    $('div[id^="AR"]').addClass("block");
                    $(".flagbox").css("text-align", "right");
                    break;
                case 1033: //English
                default:
                    $('div[id^="AR"]').removeClass("block");
                    $('div[id^="EN"]').removeClass("none");
                    $('div[id^="AR"]').addClass("none");
                    $('div[id^="EN"]').addClass("block");
                    break;
            }
           
        };
    </script>
</body>
</html>